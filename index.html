<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Ù†Ø¸Ø§Ù… Ø­Ø³Ø§Ø¨ Ø¬Ø±Ø¹Ø§Øª Ø§Ù„ØªØ®Ø¯ÙŠØ±</title>
<style>
  body{font-family:Arial, sans-serif;direction:rtl;background:#f0f2f5;margin:0;padding:20px}
  .wrap{max-width:900px;margin:0 auto}
  h1{color:#0a5275}
  .row{display:flex;gap:12px;flex-wrap:wrap}
  .btn{padding:10px 14px;border-radius:8px;border:none;background:#007bff;color:#fff;cursor:pointer}
  .btn:active{transform:translateY(1px)}
  .panel{background:#fff;padding:18px;border-radius:12px;box-shadow:0 4px 18px rgba(0,0,0,.06);margin-top:16px}
  label{display:block;text-align:right;margin:6px 0}
  input,select,textarea{width:100%;padding:10px;border-radius:8px;border:1px solid #cfcfcf;margin-top:6px}
  .sideEffect{background:#fff6f6;border-left:4px solid #ff6b6b;padding:10px;margin:8px 0;border-radius:6px;text-align:right}
  .chatBox{height:200px;overflow:auto;padding:10px;background:#eef2f7;border-radius:8px}
  .muted{color:#666;font-size:13px}
  .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:12px}
</style>
</head>
<body>
<div class="wrap">
  <h1>ğŸš‘ Ù†Ø¸Ø§Ù… Ø­Ø³Ø§Ø¨ Ø¬Ø±Ø¹Ø§Øª Ø§Ù„ØªØ®Ø¯ÙŠØ± - Ù…ØªÙƒØ§Ù…Ù„</h1>

  <div class="row">
    <button class="btn" id="showDose">Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¬Ø±Ø¹Ø§Øª</button>
    <button class="btn" id="showFluids">Ø­Ø³Ø§Ø¨ Ø§Ù„Ø³ÙˆØ§Ø¦Ù„ ÙˆØ§Ù„Ø¯Ù…</button>
    <button class="btn" id="showAirway">Ø§Ù„Ø§Ø±Ù†ØºÙˆØ³ÙƒÙˆØ¨ Ùˆ ETT</button>
    <button class="btn" id="showAdmin">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</button>
  </div>

  <div class="panel" id="panelDose" style="display:none">
    <h2>ğŸ’‰ Ø­Ø³Ø§Ø¨ Ø¬Ø±Ø¹Ø§Øª Ø§Ù„ØªØ®Ø¯ÙŠØ±</h2>
    <div class="grid">
      <div>
        <label>ÙˆØ²Ù† Ø§Ù„Ù…Ø±ÙŠØ¶ (ÙƒØº)
          <input id="weightDose" type="number" min="0" step="0.1" placeholder="Ù…Ø«Ù„Ø§Ù‹: 70">
        </label>
        <label>Ø¹Ù…Ø± Ø§Ù„Ù…Ø±ÙŠØ¶
          <div style="display:flex;gap:8px">
            <input id="ageDose" type="number" min="0" step="1" placeholder="Ø¶Ø¹ Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¹Ù…Ø±">
            <select id="ageUnitDose" style="width:150px">
              <option value="years">Ø³Ù†ÙˆØ§Øª</option>
              <option value="months">Ø£Ø´Ù‡Ø±</option>
              <option value="days">Ø£ÙŠØ§Ù…</option>
            </select>
          </div>
        </label>
        <label>Ø§Ø®ØªØ± Ø§Ù„Ø¯ÙˆØ§Ø¡
          <select id="drugDose"></select>
        </label>
        <button class="btn" id="calcDose">Ø§Ø­Ø³Ø¨ Ø§Ù„Ø¬Ø±Ø¹Ø©</button>
      </div>

      <div>
        <div id="doseResult" class="muted">Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø³ØªØ¸Ù‡Ø± Ù‡Ù†Ø§</div>
        <div id="doseEffects" style="margin-top:12px"></div>
      </div>
    </div>

    <hr style="margin:12px 0">
    <h3>ğŸ’¬ Ø´Ø§Øª Ø§Ù„Ù‚Ø³Ù…</h3>
    <div class="chatBox" id="doseChat"></div>
    <textarea id="doseChatInput" placeholder="Ø§ÙƒØªØ¨ Ø³Ø¤Ø§Ù„Ùƒ Ù‡Ù†Ø§..." style="margin-top:8px"></textarea>
    <div style="margin-top:8px">
      <button class="btn" id="doseChatSend">Ø£Ø±Ø³Ù„</button>
    </div>
  </div>

  <div class="panel" id="panelFluids" style="display:none">
    <h2>ğŸ’§ Ø­Ø³Ø§Ø¨ Ø§Ù„Ø³ÙˆØ§Ø¦Ù„ ÙˆØ§Ù„Ø¯Ù…</h2>
    <div class="grid">
      <div>
        <label>ÙˆØ²Ù† Ø§Ù„Ù…Ø±ÙŠØ¶ (ÙƒØº)
          <input id="weightFluids" type="number" min="0" step="0.1">
        </label>
        <label>Ø¹Ù…Ø± Ø§Ù„Ù…Ø±ÙŠØ¶
          <div style="display:flex;gap:8px">
            <input id="ageFluids" type="number" min="0" step="1">
            <select id="ageUnitFluids" style="width:150px">
              <option value="years">Ø³Ù†ÙˆØ§Øª</option>
              <option value="months">Ø£Ø´Ù‡Ø±</option>
              <option value="days">Ø£ÙŠØ§Ù…</option>
            </select>
          </div>
        </label>
        <button class="btn" id="calcFluids">Ø§Ø­Ø³Ø¨ Ø§Ù„Ø³ÙˆØ§Ø¦Ù„/Ø§Ù„Ø¯Ù…</button>
      </div>

      <div>
        <div id="fluidsResult" class="muted">Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø³ØªØ¸Ù‡Ø± Ù‡Ù†Ø§</div>
      </div>
    </div>

    <hr style="margin:12px 0">
    <h3>ğŸ’¬ Ø´Ø§Øª Ø§Ù„Ù‚Ø³Ù…</h3>
    <div class="chatBox" id="fluidsChat"></div>
    <textarea id="fluidsChatInput" placeholder="Ø§ÙƒØªØ¨ Ø³Ø¤Ø§Ù„Ùƒ Ù‡Ù†Ø§..." style="margin-top:8px"></textarea>
    <div style="margin-top:8px">
      <button class="btn" id="fluidsChatSend">Ø£Ø±Ø³Ù„</button>
    </div>
  </div>

  <div class="panel" id="panelAirway" style="display:none">
    <h2>ğŸ˜· Ø§Ù„Ù„Ø§Ø±Ù†ØºÙˆØ³ÙƒÙˆØ¨ Ùˆ ETT</h2>
    <div class="grid">
      <div>
        <label>Ø¹Ù…Ø± Ø§Ù„Ù…Ø±ÙŠØ¶
          <div style="display:flex;gap:8px">
            <input id="ageAirway" type="number" min="0" step="1">
            <select id="ageUnitAirway" style="width:150px">
              <option value="years">Ø³Ù†ÙˆØ§Øª</option>
              <option value="months">Ø£Ø´Ù‡Ø±</option>
              <option value="days">Ø£ÙŠØ§Ù…</option>
            </select>
          </div>
        </label>
        <label>ÙˆØ²Ù† Ø§Ù„Ù…Ø±ÙŠØ¶ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
          <input id="weightAirway" type="number" step="0.1">
        </label>
        <button class="btn" id="calcAirway">Ø­Ø³Ø§Ø¨ Ø§Ù„Ø­Ø¬Ù…</button>
      </div>

      <div>
        <div id="airwayResult" class="muted">Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø³ØªØ¸Ù‡Ø± Ù‡Ù†Ø§</div>
      </div>
    </div>

    <hr style="margin:12px 0">
    <h3>ğŸ’¬ Ø´Ø§Øª Ø§Ù„Ù‚Ø³Ù…</h3>
    <div class="chatBox" id="airwayChat"></div>
    <textarea id="airwayChatInput" placeholder="Ø§ÙƒØªØ¨ Ø³Ø¤Ø§Ù„Ùƒ Ù‡Ù†Ø§..." style="margin-top:8px"></textarea>
    <div style="margin-top:8px">
      <button class="btn" id="airwayChatSend">Ø£Ø±Ø³Ù„</button>
    </div>
  </div>

  <div class="panel" id="panelAdmin" style="display:none">
    <h2>ğŸ”§ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… (Ù…Ø§Ù„Ùƒ)</h2>
    <label>ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø§Ù„Ù…Ø§Ù„Ùƒ
      <input id="adminPass" type="password">
    </label>
    <div style="margin-top:8px">
      <button class="btn" id="adminLogin">Ø¯Ø®ÙˆÙ„</button>
    </div>

    <div id="adminArea" style="display:none;margin-top:12px">
      <h3>ØªØ¹Ø¯ÙŠÙ„ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø£Ø¹Ø±Ø§Ø¶ Ù…Ø¤Ù‚ØªØ§Ù‹</h3>
      <p class="muted">ØµÙŠØºØ© ÙƒÙ„ Ø³Ø·Ø±: drug, dosePerKg, side, treatment</p>
      <textarea id="adminEdit" rows="6" placeholder="Ù…Ø«Ø§Ù„: propofol,2,Ø¯ÙˆØ®Ø©,Ø±ÙØ¹ Ø§Ù„Ù‚Ø¯Ù…"></textarea>
      <div style="margin-top:8px">
        <button class="btn" id="adminSave">Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª</button>
      </div>
    </div>
  </div>

</div>

<script>
// ---------- ÙˆØ¸Ø§Ø¦Ù Ø¹Ø§Ù…Ø© ----------
const panels = { dose: document.getElementById('panelDose'), fluids: document.getElementById('panelFluids'), airway: document.getElementById('panelAirway'), admin: document.getElementById('panelAdmin') };
function hideAll(){ Object.values(panels).forEach(p=>p.style.display='none'); }
document.getElementById('showDose').addEventListener('click',()=>{ hideAll(); panels.dose.style.display='block'; });
document.getElementById('showFluids').addEventListener('click',()=>{ hideAll(); panels.fluids.style.display='block'; });
document.getElementById('showAirway').addEventListener('click',()=>{ hideAll(); panels.airway.style.display='block'; });
document.getElementById('showAdmin').addEventListener('click',()=>{ hideAll(); panels.admin.style.display='block'; });

// Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ©
let sideEffectsData = { propofol:[{dosePerKg:2,side:'Ø¯ÙˆØ®Ø©',treatment:'Ø±ÙØ¹ Ø§Ù„Ù‚Ø¯Ù…'}], midazolam:[{dosePerKg:0.1,side:'Ù†Ø¹Ø§Ø³',treatment:'Ù…Ø±Ø§Ù‚Ø¨Ø©'}] };

// Ù…Ù„Ø¡ Ø§Ù„Ø£Ø¯ÙˆÙŠØ©
function populateDrugs(){
  const drugSelect=document.getElementById('drugDose');
  drugSelect.innerHTML=''; Object.keys(sideEffectsData).forEach(k=>{ const opt=document.createElement('option'); opt.value=k; opt.textContent=k; drugSelect.appendChild(opt); });
}
populateDrugs();

// ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¹Ù…Ø±
function ageToYears(value,unit){ const v=parseFloat(value); if(isNaN(v)||v<0) return NaN; if(unit==='years') return v; if(unit==='months') return v/12; if(unit==='days') return v/365; return NaN; }

// Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¬Ø±Ø¹Ø§Øª
document.getElementById('calcDose').addEventListener('click',()=>{
  const w=parseFloat(document.getElementById('weightDose').value);
  const ageVal=document.getElementById('ageDose').value;
  const ageUnit=document.getElementById('ageUnitDose').value;
  const drug=document.getElementById('drugDose').value;
  const resDiv=document.getElementById('doseResult');
  const effectsDiv=document.getElementById('doseEffects');
  resDiv.innerHTML=''; effectsDiv.innerHTML='';
  if(!drug){ alert('Ø§Ø®ØªØ± Ø¯ÙˆØ§Ø¡Ù‹'); return; }
  if(isNaN(w)||w<=0){ alert('Ø£Ø¯Ø®Ù„ ÙˆØ²Ù† ØµØ­ÙŠØ­'); return; }
  const ageYears=ageToYears(ageVal,ageUnit); if(isNaN(ageYears)){ alert('Ø£Ø¯Ø®Ù„ Ø¹Ù…Ø± ØµØ­ÙŠØ­'); return; }
  const list=sideEffectsData[drug]; if(!list||list.length===0){ resDiv.textContent='Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù‡Ø°Ø§ Ø§Ù„Ø¯ÙˆØ§Ø¡'; return; }
  const referenceDose=list[0].dosePerKg;
  const totalDose=w*referenceDose;
  resDiv.innerHTML=`<strong>Ø§Ù„Ø¬Ø±Ø¹Ø© Ø§Ù„Ù…Ø±Ø¬Ø¹ÙŠØ© (${referenceDose} Ù…Ù„Øº/ÙƒØº):</strong> ${totalDose.toFixed(2)} Ù…Ù„Øº`;
  const shown=new Set();
  list.forEach(item=>{ const dpkg=Number(item.dosePerKg); const doseForThis=(w*dpkg).toFixed(2); const key=`${item.side}||${item.treatment}||${doseForThis}`; if(shown.has(key)) return; shown.add(key); effectsDiv.innerHTML+=`<div class="sideEffect"><div><strong>Ø¬Ø±Ø¹Ø© Ù…Ø±ØªØ¨Ø·Ø©:</strong> ${doseForThis} Ù…Ù„Øº</div><div><strong>Ø§Ù„Ø¹Ø±Ø¶:</strong> ${item.side}</div><div><strong>Ø§Ù„Ø¹Ù„Ø§Ø¬ Ø§Ù„Ù…Ù‚ØªØ±Ø­:</strong> ${item.treatment}</div></div>`; });
});

// Ø§Ù„Ø³ÙˆØ§Ø¦Ù„
document.getElementById('calcFluids').addEventListener('click',()=>{
  const w=parseFloat(document.getElementById('weightFluids').value);
  const ageVal=document.getElementById('ageFluids').value;
  const ageUnit=document.getElementById('ageUnitFluids').value;
  const out=document.getElementById('fluidsResult'); out.innerHTML='';
  if(isNaN(w)||w<=0){ alert('Ø£Ø¯Ø®Ù„ ÙˆØ²Ù† ØµØ­ÙŠØ­'); return; }
  const ageYears=ageToYears(ageVal,ageUnit); if(isNaN(ageYears)){ alert('Ø£Ø¯Ø®Ù„ Ø¹Ù…Ø± ØµØ­ÙŠØ­'); return; }
  const maintenance=(w*30).toFixed(0);
  const bloodLiters=((w*70)/1000).toFixed(2);
  out.innerHTML=`<div><strong>ÙƒÙ…ÙŠØ© Ø§Ù„Ø³ÙˆØ§Ø¦Ù„ Ø§Ù„Ù…Ø¨Ø¯Ø¦ÙŠØ©:</strong> ${maintenance} Ù…Ù„/Ø§Ù„ÙŠÙˆÙ…</div><div><strong>Ø­Ø¬Ù… Ø§Ù„Ø¯Ù… Ø§Ù„ØªÙ‚Ø±ÙŠØ¨ÙŠ:</strong> ${bloodLiters} Ù„ØªØ±</div>`;
});

// Ø§Ù„Ù„Ø§Ø±Ù†ØºÙˆØ³ÙƒÙˆØ¨
document.getElementById('calcAirway').addEventListener('click',()=>{
  const ageVal=document.getElementById('ageAirway').value;
  const ageUnit=document.getElementById('ageUnitAirway').value;
  const w=parseFloat(document.getElementById('weightAirway').value);
  const out=document.getElementById('airwayResult'); out.innerHTML='';
  const ageYears=ageToYears(ageVal,ageUnit); if(isNaN(ageYears)){ alert('Ø£Ø¯Ø®Ù„ Ø¹Ù…Ø± ØµØ­ÙŠØ­'); return; }
  let bladeSize='',ettSize='';
  if(ageYears<1){ bladeSize='Ø­Ø¬Ù… 0'; ettSize='3.0-3.5 mm'; }
  else if(ageYears<2){ bladeSize='Ø­Ø¬Ù… 1'; ettSize='3.5-4.0 mm'; }
  else if(ageYears<5){ bladeSize='Ø­Ø¬Ù… 2'; ettSize='4.0-4.5 mm'; }
  else if(ageYears<12){ bladeSize='Ø­Ø¬Ù… 3'; ettSize='4.5-5.5 mm'; }
  else{ bladeSize='Ø­Ø¬Ù… 4 (Ø¨Ø§Ù„Øº)'; ettSize=`${Math.floor(ageYears/4+4)} mm`; }
  if(!isNaN(w)&&w>0){ out.innerHTML=`<div><strong>Ø´ÙØ±Ø© Ø§Ù„Ù„Ø§Ø±Ù†ØºÙˆ:</strong> ${bladeSize}</div><div><strong>ETT Ù…Ù‚ØªØ±Ø­:</strong> ${ettSize}</div><div class="muted">Ù…Ù„Ø§Ø­Ø¸Ø©: Ø§Ø³ØªØ®Ø¯Ù… ØªÙ‚Ø¯ÙŠØ±Ø§Øª Ø§Ù„ÙˆØ²Ù† Ù„Ù„Ø£Ø·ÙØ§Ù„ ÙˆØ§Ù„Ø±Ø¶Ø¹.</div>`; }
  else { out.innerHTML=`<div><strong>Ø´ÙØ±Ø© Ø§Ù„Ù„Ø§Ø±Ù†ØºÙˆ:</strong> ${bladeSize}</div><div><strong>ETT Ù…Ù‚ØªØ±Ø­:</strong> ${ettSize}</div>`; }
});

// Ø´Ø§ØªØ§Øª
function appendChat(boxId, role, text){ const box=document.getElementById(boxId); const p=document.createElement('div'); p.style.margin='6px 0'; p.innerHTML=`<strong>${role}:</strong> ${text}`; box.appendChild(p); box.scrollTop=box.scrollHeight; }
document.getElementById('doseChatSend').addEventListener('click',()=>{ const input=document.getElementById('doseChatInput'); const text=input.value.trim(); if(!text) return; appendChat('doseChat','Ø£Ù†Øª',text); appendChat('doseChat','AI','Ø±Ø¯ Ø§ÙØªØ±Ø§Ø¶ÙŠ: ÙŠØ±Ø¬Ù‰ Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø³Ø¬Ù„ Ø§Ù„Ø·Ø¨ÙŠ.'); input.value=''; });
document.getElementById('fluidsChatSend').addEventListener('click',()=>{ const input=document.getElementById('fluidsChatInput'); const text=input.value.trim(); if(!text) return; appendChat('fluidsChat','Ø£Ù†Øª',text); appendChat('fluidsChat','AI','Ø±Ø¯ Ø§ÙØªØ±Ø§Ø¶ÙŠ: ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø³ÙˆØ§Ø¦Ù„ ÙˆØ§Ù„Ø¹Ù„Ø§Ù…Ø§Øª Ø§Ù„Ø­ÙŠÙˆÙŠØ©.'); input.value=''; });
document.getElementById('airwayChatSend').addEventListener('click',()=>{ const input=document.getElementById('airwayChatInput'); const text=input.value.trim(); if(!text) return; appendChat('airwayChat','Ø£Ù†Øª',text); appendChat('airwayChat','AI','Ø±Ø¯ Ø§ÙØªØ±Ø§Ø¶ÙŠ: Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø­Ø¬Ù… Ø§Ù„Ù…Ù‚ØªØ±Ø­ Ø¨Ø¹Ù†Ø§ÙŠØ©.'); input.value=''; });

// Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
document.getElementById('adminLogin').addEventListener('click',()=>{ const pass=document.getElementById('adminPass').value; if(pass==='mustafa@2006#2'){ document.getElementById('adminArea').style.display='block'; alert('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙƒÙ…Ø§Ù„Ùƒ'); } else alert('ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø®Ø§Ø·Ø¦Ø©'); });
document.getElementById('adminSave').addEventListener('click',()=>{ const data=document.getElementById('adminEdit').value.trim(); if(!data){ alert('Ø£Ø¯Ø®Ù„ Ø¨ÙŠØ§Ù†Ø§Øª'); return; } const lines=data.split('\n'); lines.forEach(line=>{ const parts=line.split(','); if(parts.length>=4){ const [drug,dosePerKg,side,treatment]=parts; if(!sideEffectsData[drug]) sideEffectsData[drug]=[]; sideEffectsData[drug].push({dosePerKg:parseFloat(dosePerKg),side:side.trim(),treatment:treatment.trim()}); } }); populateDrugs(); alert('ØªÙ… ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª'); });
</script>

</body>
</html>

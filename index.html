<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>حاسبة جرعات التخدير</title>
  <style>
    body { font-family: Arial, sans-serif; direction: rtl; text-align: center; background: #f4f4f9; }
    h1 { color: #0077b6; }
    .btn { padding: 15px 25px; margin: 10px; font-size: 18px; border: none; border-radius: 10px; background: #0096c7; color: white; cursor: pointer; }
    .btn:hover { background: #0077b6; }
    .section { display: none; padding: 20px; margin-top: 20px; border: 2px solid #ddd; border-radius: 10px; background: #fff; }
    #result { margin-top: 15px; font-size: 18px; color: darkgreen; }
    #side-effects { margin-top: 20px; padding: 10px; background: #ffe6e6; border-radius: 10px; }
  </style>
</head>
<body>
  <h1>🚑 نظام حساب جرعات التخدير</h1>

  <button class="btn" onclick="showSection('dose')">💉 حساب جرعات التخدير</button>
  <button class="btn" onclick="showSection('fluids')">💧 حساب السوائل والدم</button>
  <button class="btn" onclick="showSection('airway')">😷 اللارنغوسكوب و ETT</button>
  <button class="btn" onclick="showSection('admin')">🔑 لوحة التحكم</button>

  <!-- قسم الجرعات -->
  <div id="dose" class="section">
    <h2>💉 حساب جرعات التخدير</h2>
    <label>وزن المريض (كغم): <input type="number" id="weight"></label><br><br>
    <label>عمر المريض: <input type="number" id="age"></label>
    <select id="ageUnit">
      <option value="days">أيام</option>
      <option value="months">أشهر</option>
      <option value="years" selected>سنوات</option>
    </select><br><br>
    <button class="btn" onclick="calculateDose()">احسب الجرعة</button>
    <div id="result"></div>
    <div id="side-effects"></div>
    <button class="btn" onclick="openChat('dose')">💬 دردشة الذكاء الاصطناعي</button>
  </div>

  <!-- قسم السوائل -->
  <div id="fluids" class="section">
    <h2>💧 حساب السوائل والدم</h2>
    <label>وزن المريض (كغم): <input type="number" id="fluidWeight"></label><br><br>
    <button class="btn" onclick="calculateFluids()">احسب السوائل</button>
    <div id="fluidsResult"></div>
    <button class="btn" onclick="openChat('fluids')">💬 دردشة الذكاء الاصطناعي</button>
  </div>

  <!-- قسم مجرى الهواء -->
  <div id="airway" class="section">
    <h2>😷 اختيار اللارنغوسكوب و ETT</h2>
    <label>عمر المريض (سنوات): <input type="number" id="airwayAge"></label><br><br>
    <button class="btn" onclick="calculateAirway()">اختر الحجم</button>
    <div id="airwayResult"></div>
    <button class="btn" onclick="openChat('airway')">💬 دردشة الذكاء الاصطناعي</button>
  </div>

  <!-- لوحة التحكم -->
  <div id="admin" class="section">
    <h2>🔑 لوحة التحكم</h2>
    <label>اسم المستخدم: <input type="text" id="adminUser"></label><br><br>
    <label>كلمة المرور: <input type="password" id="adminPass"></label><br><br>
    <button class="btn" onclick="loginAdmin()">تسجيل الدخول</button>
    <div id="adminPanel" style="display:none; margin-top:20px;">
      <h3>⚙️ إعدادات الموقع</h3>
      <p>يمكنك تعديل الأدوية والأعراض من backend مباشرة.</p>
    </div>
  </div>

  <script src="sideEffects.js"></script>
  <script>
    function showSection(id) {
      document.querySelectorAll('.section').forEach(sec => sec.style.display = 'none');
      document.getElementById(id).style.display = 'block';
    }

    function calculateDose() {
      const weight = parseFloat(document.getElementById("weight").value);
      const age = parseInt(document.getElementById("age").value);
      const unit = document.getElementById("ageUnit").value;
      if (!weight || !age) { alert("أدخل جميع القيم"); return; }

      let ageInYears = unit === "days" ? age / 365 : unit === "months" ? age / 12 : age;

      // معادلة افتراضية
      let dose = weight * 2;  
      document.getElementById("result").innerText = `✅ الجرعة الموصى بها: ${dose.toFixed(2)} ملغ`;

      // الأعراض الجانبية
      if (sideEffects["Propofol"]) {
        let se = sideEffects["Propofol"];
        document.getElementById("side-effects").innerHTML = `<h3>⚠️ الأعراض الجانبية:</h3><ul>${se.map(s => `<li>${s}</li>`).join("")}</ul>`;
      }
    }

    function calculateFluids() {
      const w = parseFloat(document.getElementById("fluidWeight").value);
      if (!w) { alert("أدخل الوزن"); return; }
      let fluids = w * 100;  
      document.getElementById("fluidsResult").innerText = `💧 حجم السوائل المطلوب: ${fluids} مل`;
    }

    function calculateAirway() {
      const age = parseInt(document.getElementById("airwayAge").value);
      if (!age) { alert("أدخل العمر"); return; }
      let ett = Math.floor((age / 4) + 4);
      document.getElementById("airwayResult").innerText = `😷 حجم أنبوب ETT المناسب: ${ett} مم`;
    }

    function loginAdmin() {
      const user = document.getElementById("adminUser").value;
      const pass = document.getElementById("adminPass").value;
      if (user === "admin" && pass === "mustafa@2006#2") {
        document.getElementById("adminPanel").style.display = "block";
      } else {
        alert("❌ بيانات خاطئة");
      }
    }

    function openChat(section) {
      alert(`فتح دردشة AI لقسم: ${section}`);
      // ربط Dialogflow أو أي AI هنا
    }
  </script>
</body>
</html>

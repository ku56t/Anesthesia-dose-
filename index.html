<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Ù†Ø¸Ø§Ù… Ø­Ø³Ø§Ø¨ Ø¬Ø±Ø¹Ø§Øª Ø§Ù„ØªØ®Ø¯ÙŠØ±</title>
<style>
  body{font-family:Arial, sans-serif;direction:rtl;background:#f0f2f5;margin:0;padding:20px}
  .wrap{max-width:900px;margin:0 auto}
  h1{color:#0a5275}
  .row{display:flex;gap:12px;flex-wrap:wrap}
  .btn{padding:10px 14px;border-radius:8px;border:none;background:#007bff;color:#fff;cursor:pointer}
  .btn:active{transform:translateY(1px)}
  .panel{background:#fff;padding:18px;border-radius:12px;box-shadow:0 4px 18px rgba(0,0,0,.06);margin-top:16px}
  label{display:block;text-align:right;margin:6px 0}
  input,select,textarea{width:100%;padding:10px;border-radius:8px;border:1px solid #cfcfcf;margin-top:6px}
  .sideEffect{background:#fff6f6;border-left:4px solid #ff6b6b;padding:10px;margin:8px 0;border-radius:6px;text-align:right}
  .chatBox{height:200px;overflow:auto;padding:10px;background:#eef2f7;border-radius:8px}
  .muted{color:#666;font-size:13px}
  .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:12px}
</style>
</head>
<body>
<div class="wrap">
  <h1>ğŸš‘ Ù†Ø¸Ø§Ù… Ø­Ø³Ø§Ø¨ Ø¬Ø±Ø¹Ø§Øª Ø§Ù„ØªØ®Ø¯ÙŠØ± - Ù…ØªÙƒØ§Ù…Ù„</h1>

  <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªÙ†Ù‚Ù„ -->
  <div class="row">
    <button class="btn" id="showDose">Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¬Ø±Ø¹Ø§Øª</button>
    <button class="btn" id="showFluids">Ø­Ø³Ø§Ø¨ Ø§Ù„Ø³ÙˆØ§Ø¦Ù„ ÙˆØ§Ù„Ø¯Ù…</button>
    <button class="btn" id="showAirway">Ø§Ù„Ø§Ø±Ù†ØºÙˆØ³ÙƒÙˆØ¨ Ùˆ ETT</button>
    <button class="btn" id="showAdmin">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</button>
  </div>

  <!-- Ù‚Ø³Ù… Ø§Ù„Ø¬Ø±Ø¹Ø§Øª -->
  <div class="panel" id="panelDose" style="display:none">
    <h2>ğŸ’‰ Ø­Ø³Ø§Ø¨ Ø¬Ø±Ø¹Ø§Øª Ø§Ù„ØªØ®Ø¯ÙŠØ±</h2>
    <div class="grid">
      <div>
        <label>ÙˆØ²Ù† Ø§Ù„Ù…Ø±ÙŠØ¶ (ÙƒØº)
          <input id="weightDose" type="number" min="0" step="0.1" placeholder="Ù…Ø«Ù„Ø§Ù‹: 70">
        </label>
        <label>Ø¹Ù…Ø± Ø§Ù„Ù…Ø±ÙŠØ¶
          <div style="display:flex;gap:8px">
            <input id="ageDose" type="number" min="0" step="1" placeholder="Ø¶Ø¹ Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¹Ù…Ø±">
            <select id="ageUnitDose" style="width:150px">
              <option value="years">Ø³Ù†ÙˆØ§Øª</option>
              <option value="months">Ø£Ø´Ù‡Ø±</option>
              <option value="days">Ø£ÙŠØ§Ù…</option>
            </select>
          </div>
        </label>
        <label>Ø§Ø®ØªØ± Ø§Ù„Ø¯ÙˆØ§Ø¡
          <select id="drugDose"></select>
        </label>
        <button class="btn" id="calcDose">Ø§Ø­Ø³Ø¨ Ø§Ù„Ø¬Ø±Ø¹Ø©</button>
      </div>

      <div>
        <div id="doseResult" class="muted">Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø³ØªØ¸Ù‡Ø± Ù‡Ù†Ø§</div>
        <div id="doseEffects" style="margin-top:12px"></div>
      </div>
    </div>

    <hr style="margin:12px 0">

    <h3>ğŸ’¬ Ø´Ø§Øª Ø§Ù„Ù‚Ø³Ù…</h3>
    <div class="chatBox" id="doseChat"></div>
    <textarea id="doseChatInput" placeholder="Ø§ÙƒØªØ¨ Ø³Ø¤Ø§Ù„Ùƒ Ù‡Ù†Ø§..." style="margin-top:8px"></textarea>
    <div style="margin-top:8px">
      <button class="btn" id="doseChatSend">Ø£Ø±Ø³Ù„</button>
    </div>
  </div>

  <!-- Ù‚Ø³Ù… Ø§Ù„Ø³ÙˆØ§Ø¦Ù„ -->
  <div class="panel" id="panelFluids" style="display:none">
    <h2>ğŸ’§ Ø­Ø³Ø§Ø¨ Ø§Ù„Ø³ÙˆØ§Ø¦Ù„ ÙˆØ§Ù„Ø¯Ù…</h2>
    <div class="grid">
      <div>
        <label>ÙˆØ²Ù† Ø§Ù„Ù…Ø±ÙŠØ¶ (ÙƒØº)
          <input id="weightFluids" type="number" min="0" step="0.1">
        </label>
        <label>Ø¹Ù…Ø± Ø§Ù„Ù…Ø±ÙŠØ¶
          <div style="display:flex;gap:8px">
            <input id="ageFluids" type="number" min="0" step="1">
            <select id="ageUnitFluids" style="width:150px">
              <option value="years">Ø³Ù†ÙˆØ§Øª</option>
              <option value="months">Ø£Ø´Ù‡Ø±</option>
              <option value="days">Ø£ÙŠØ§Ù…</option>
            </select>
          </div>
        </label>
        <button class="btn" id="calcFluids">Ø§Ø­Ø³Ø¨ Ø§Ù„Ø³ÙˆØ§Ø¦Ù„/Ø§Ù„Ø¯Ù…</button>
      </div>

      <div>
        <div id="fluidsResult" class="muted">Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø³ØªØ¸Ù‡Ø± Ù‡Ù†Ø§</div>
      </div>
    </div>

    <hr style="margin:12px 0">
    <h3>ğŸ’¬ Ø´Ø§Øª Ø§Ù„Ù‚Ø³Ù…</h3>
    <div class="chatBox" id="fluidsChat"></div>
    <textarea id="fluidsChatInput" placeholder="Ø§ÙƒØªØ¨ Ø³Ø¤Ø§Ù„Ùƒ Ù‡Ù†Ø§..." style="margin-top:8px"></textarea>
    <div style="margin-top:8px">
      <button class="btn" id="fluidsChatSend">Ø£Ø±Ø³Ù„</button>
    </div>
  </div>

  <!-- Ù‚Ø³Ù… Ø§Ù„Ù„Ø§Ø±Ù†ØºÙˆØ³ÙƒÙˆØ¨/ETT -->
  <div class="panel" id="panelAirway" style="display:none">
    <h2>ğŸ˜· Ø§Ù„Ù„Ø§Ø±Ù†ØºÙˆØ³ÙƒÙˆØ¨ Ùˆ ETT</h2>
    <div class="grid">
      <div>
        <label>Ø¹Ù…Ø± Ø§Ù„Ù…Ø±ÙŠØ¶
          <div style="display:flex;gap:8px">
            <input id="ageAirway" type="number" min="0" step="1">
            <select id="ageUnitAirway" style="width:150px">
              <option value="years">Ø³Ù†ÙˆØ§Øª</option>
              <option value="months">Ø£Ø´Ù‡Ø±</option>
              <option value="days">Ø£ÙŠØ§Ù…</option>
            </select>
          </div>
        </label>
        <label>ÙˆØ²Ù† Ø§Ù„Ù…Ø±ÙŠØ¶ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
          <input id="weightAirway" type="number" step="0.1">
        </label>
        <button class="btn" id="calcAirway">Ø­Ø³Ø§Ø¨ Ø§Ù„Ø­Ø¬Ù…</button>
      </div>

      <div>
        <div id="airwayResult" class="muted">Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø³ØªØ¸Ù‡Ø± Ù‡Ù†Ø§</div>
      </div>
    </div>

    <hr style="margin:12px 0">
    <h3>ğŸ’¬ Ø´Ø§Øª Ø§Ù„Ù‚Ø³Ù…</h3>
    <div class="chatBox" id="airwayChat"></div>
    <textarea id="airwayChatInput" placeholder="Ø§ÙƒØªØ¨ Ø³Ø¤Ø§Ù„Ùƒ Ù‡Ù†Ø§..." style="margin-top:8px"></textarea>
    <div style="margin-top:8px">
      <button class="btn" id="airwayChatSend">Ø£Ø±Ø³Ù„</button>
    </div>
  </div>

  <!-- Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø¨Ø³ÙŠØ·Ø© -->
  <div class="panel" id="panelAdmin" style="display:none">
    <h2>ğŸ”§ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… (Ù…Ø§Ù„Ùƒ)</h2>
    <label>ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø§Ù„Ù…Ø§Ù„Ùƒ
      <input id="adminPass" type="password">
    </label>
    <div style="margin-top:8px">
      <button class="btn" id="adminLogin">Ø¯Ø®ÙˆÙ„</button>
    </div>

    <div id="adminArea" style="display:none;margin-top:12px">
      <h3>ØªØ¹Ø¯ÙŠÙ„ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø£Ø¹Ø±Ø§Ø¶ Ù…Ø¤Ù‚ØªØ§Ù‹</h3>
      <p class="muted">ØµÙŠØºØ© ÙƒÙ„ Ø³Ø·Ø±: drug, dosePerKg, side, treatment</p>
      <textarea id="adminEdit" rows="6" placeholder="Ù…Ø«Ø§Ù„: propofol,2,Ø¯ÙˆØ®Ø©,Ø±ÙØ¹ Ø§Ù„Ù‚Ø¯Ù…"></textarea>
      <div style="margin-top:8px">
        <button class="btn" id="adminSave">Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª</button>
      </div>
    </div>
  </div>

</div>

<script type="module">
  // ---------- Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø£Ø¯ÙˆÙŠØ© ÙˆØ§Ù„Ø£Ø¹Ø±Ø§Ø¶ ----------
  const sideEffectsData = {
    "propofol": [
      { dosePerKg: 2.0, side: "Ø§Ù†Ø®ÙØ§Ø¶ Ø¶ØºØ· Ø§Ù„Ø¯Ù…", treatment: "Ø±ÙØ¹ Ø§Ù„Ù‚Ø¯Ù…ÙŠÙ†ØŒ Ø¥Ø¨Ø·Ø§Ø¡ Ø§Ù„Ø­Ù‚Ù†ØŒ Ù…Ø­Ù„ÙˆÙ„ ÙˆØ±ÙŠØ¯ÙŠ" },
      { dosePerKg: 2.0, side: "ØªØ«Ø¨ÙŠØ· ØªÙ†ÙØ³ÙŠ", treatment: "Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„ØªÙ†ÙØ³ØŒ Ø¯Ø¹Ù… Ø£ÙƒØ³Ø¬ÙŠÙ†ØŒ ØªØ¬Ù‡ÙŠØ² Ø§Ù„Ø£Ø¯ÙˆØ§Øª Ø§Ù„ØªÙ†ÙØ³ÙŠØ©" },
      { dosePerKg: 2.0, side: "ØºØ«ÙŠØ§Ù†/Ù‚ÙŠØ¡ Ø¨Ø¹Ø¯ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©", treatment: "Ø£Ø¯ÙˆÙŠØ© Ù…Ø¶Ø§Ø¯Ø© Ù„Ù„ØºØ«ÙŠØ§Ù† (ondansetron)" }
    ],
    "midazolam": [
      { dosePerKg: 0.1, side: "Ù†Ø¹Ø§Ø³/ØªØ®Ø¯ÙŠØ± Ù…ÙØ±Ø·", treatment: "Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„ØªÙ†ÙØ³ ÙˆØ§Ù„ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø­ÙŠÙˆÙŠØ©ØŒ ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ø¬Ø±Ø¹Ø©" },
      { dosePerKg: 0.1, side: "Ø§Ø±ØªØ®Ø§Ø¡ Ø¹Ø¶Ù„ÙŠ", treatment: "Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ø­Ø±ÙƒØ§Øª Ø§Ù„ØªÙ†ÙØ³ÙŠØ©ØŒ Ø¯Ø¹Ù… ØªÙ†ÙØ³ÙŠ Ø¹Ù†Ø¯ Ø§Ù„Ø­Ø§Ø¬Ø©" }
    ],
    "fentanyl": [
      { dosePerKg: 0.002, side: "ØªØ«Ø¨ÙŠØ· ØªÙ†ÙØ³ÙŠ Ø´Ø¯ÙŠØ¯", treatment: "Ø¯Ø¹Ù… Ø§Ù„Ø£ÙƒØ³Ø¬ÙŠÙ†ØŒ Ù†Ø§Ù„ÙˆÙƒØ³ÙˆÙ† Ø¥Ø°Ø§ Ù„Ø²Ù…ØŒ Ù…Ø±Ø§Ù‚Ø¨Ø© ØµÙØ© Ø§Ù„ØªÙ†ÙØ³" },
      { dosePerKg: 0.002, side: "ØºØ«ÙŠØ§Ù†/Ù‚ÙŠØ¡", treatment: "Ù…Ø¶Ø§Ø¯Ø§Øª Ø§Ù„Ù‚ÙŠØ¡" },
      { dosePerKg: 0.002, side: "Ø­ÙƒØ©", treatment: "Ù…Ø¶Ø§Ø¯Ø§Øª Ù‡Ø³ØªØ§Ù…ÙŠÙ† Ø¹Ù†Ø¯ Ø§Ù„Ø¶Ø±ÙˆØ±Ø©" }
    ],
    "ketamine": [
      { dosePerKg: 1.5, side: "Ù‡Ù„ÙˆØ³Ø©/ÙƒÙˆØ§Ø¨ÙŠØ³ Ù†ÙØ³ÙŠØ©", treatment: "Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¨Ù†Ø²ÙˆØ¯ÙŠØ§Ø²ÙŠØ¨ÙŠÙ† ÙƒÙ…Ø¶Ø§Ø¯ (Ù…Ø«Ù„Ø§Ù‹ midazolam) ÙˆÙ…Ø­ÙŠØ· Ù‡Ø§Ø¯Ø¦" },
      { dosePerKg: 1.5, side: "Ø§Ø±ØªÙØ§Ø¹ Ø¶ØºØ· Ø§Ù„Ø¯Ù… ÙˆÙ…Ø¹Ø¯Ù„ Ø¶Ø±Ø¨Ø§Øª Ø§Ù„Ù‚Ù„Ø¨", treatment: "Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ø¶ØºØ·ØŒ Ø£Ø¯ÙˆÙŠØ© Ø®Ø§ÙØ¶Ø© Ø¹Ù†Ø¯ Ø§Ù„Ø­Ø§Ø¬Ø©" },
      { dosePerKg: 1.5, side: "Ø²ÙŠØ§Ø¯Ø© Ø¥ÙØ±Ø§Ø² Ø§Ù„Ù„Ø¹Ø§Ø¨", treatment: "Ù…ÙÙ‚ÙÙÙ„Ù‘Ø§Øª Ø§Ù„Ø¥ÙØ±Ø§Ø² (glycopyrrolate) Ø¹Ù†Ø¯ Ø§Ù„Ø­Ø§Ø¬Ø©" }
    ]
  };

  // ---------- Ø¹Ù†Ø§ØµØ± Ø§Ù„ØªØ­ÙƒÙ… ----------
  const panels = {
    dose: document.getElementById('panelDose'),
    fluids: document.getElementById('panelFluids'),
    airway: document.getElementById('panelAirway'),
    admin: document.getElementById('panelAdmin')
  };

  function hideAll(){ Object.values(panels).forEach(p => p.style.display = 'none'); }

  document.getElementById('showDose').addEventListener('click', ()=> { hideAll(); panels.dose.style.display='block'; });
  document.getElementById('showFluids').addEventListener('click', ()=> { hideAll(); panels.fluids.style.display='block'; });
  document.getElementById('showAirway').addEventListener('click', ()=> { hideAll(); panels.airway.style.display='block'; });
  document.getElementById('showAdmin').addEventListener('click', ()=> { hideAll(); panels.admin.style.display='block'; });

  // ---------- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ø¯ÙˆÙŠØ© ----------
  const drugSelect = document.getElementById('drugDose');
  function populateDrugs(){
    drugSelect.innerHTML = '';
    const keys = Object.keys(sideEffectsData);
    if(keys.length===0){
      const opt=document.createElement('option'); opt.value=''; opt.textContent='Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ø¯ÙˆÙŠØ© ÙÙŠ Ø§Ù„Ù‚Ø§Ø¹Ø¯Ø©'; drugSelect.appendChild(opt);
    } else {
      keys.forEach(k=>{
        const opt=document.createElement('option'); opt.value=k; opt.textContent=k; drugSelect.appendChild(opt);
      });
    }
  }
  populateDrugs();

  // ---------- ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¹Ù…Ø± ----------
  function ageToYears(value,unit){
    const v=parseFloat(value);
    if(isNaN(v)||v<0) return NaN;
    if(unit==='years') return v;
    if(unit==='months') return v/12;
    if(unit==='days') return v/365;
    return NaN;
  }

  // ---------- Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¬Ø±Ø¹Ø© ----------
  document.getElementById('calcDose').addEventListener('click', ()=>{
    const w=parseFloat(document.getElementById('weightDose').value);
    const ageVal=document.getElementById('ageDose').value;
    const ageUnit=document.getElementById('ageUnitDose').value;
    const drug=document.getElementById('drugDose').value;

    if(isNaN(w)||w<=0){ alert('Ø£Ø¯Ø®Ù„ ÙˆØ²Ù† ØµØ­ÙŠØ­'); return; }
    if(!drug || !sideEffectsData[drug]){ alert('Ø§Ø®ØªØ± Ø¯ÙˆØ§Ø¡ ØµØ­ÙŠØ­'); return; }

    const effects = sideEffectsData[drug];
    const effectsDiv = document.getElementById('doseEffects');
    effectsDiv.innerHTML = '';

    // Ø­Ø³Ø§Ø¨ ÙƒÙ„ Ø§Ù„Ø¬Ø±Ø¹Ø§Øª Ù„ÙƒÙ„ ØªØ£Ø«ÙŠØ±
    effects.forEach(e=>{
      const dose = e.dosePerKg * w;
      const div = document.createElement('div');
      div.className='sideEffect';
      div.innerHTML=`<strong>Ø§Ù„Ø¬Ø±Ø¹Ø©:</strong> ${dose.toFixed(2)} Ù…Ù„/ÙƒØº<br><strong>Ø§Ù„Ø¹Ø±Ø¶:</strong> ${e.side}<br><strong>Ø§Ù„Ø¹Ù„Ø§Ø¬:</strong> ${e.treatment}`;
      effectsDiv.appendChild(div);
    });

    document.getElementById('doseResult').innerHTML = `<strong>ØªÙ… Ø­Ø³Ø§Ø¨ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¬Ø±Ø¹Ø§Øª Ù„ÙƒÙ„ ØªØ£Ø«ÙŠØ± Ø¯ÙˆØ§Ø¦ÙŠ.</strong>`;
  });

  // ---------- Ø­Ø³Ø§Ø¨ Ø§Ù„Ø³ÙˆØ§Ø¦Ù„/Ø§Ù„Ø¯Ù… ----------
  document.getElementById('calcFluids').addEventListener('click', ()=>{
    const w=parseFloat(document.getElementById('weightFluids').value);
    if(isNaN(w)||w<=0){ alert('Ø£Ø¯Ø®Ù„ ÙˆØ²Ù† ØµØ­ÙŠØ­'); return; }
    const fluidRate = 10*w;
    document.getElementById('fluidsResult').innerHTML = `<strong>Ù…Ø¹Ø¯Ù„ Ø§Ù„Ø³ÙˆØ§Ø¦Ù„:</strong> ${fluidRate.toFixed(2)} Ù…Ù„/Ø³Ø§Ø¹Ø©`;
  });

  // ---------- Ø­Ø³Ø§Ø¨ Ø§Ù„Ù„Ø§Ø±Ù†ØºÙˆØ³ÙƒÙˆØ¨/ETT ----------
  document.getElementById('calcAirway').addEventListener('click', ()=>{
    const age=parseFloat(document.getElementById('ageAirway').value);
    if(isNaN(age)||age<0){ alert('Ø£Ø¯Ø®Ù„ Ø¹Ù…Ø± ØµØ­ÙŠØ­'); return; }
    let tubeSize=0;
    if(age<1) tubeSize=3.0;
    else if(age<2) tubeSize=3.5;
    else if(age<4) tubeSize=4.0;
    else if(age<6) tubeSize=4.5;
    else tubeSize=5 + ((age-6)/4);
    document.getElementById('airwayResult').innerHTML=`Ø§Ù„Ø­Ø¬Ù… Ø§Ù„Ù…ÙˆØµÙ‰ Ø¨Ù‡ Ù„Ù„Ù€ ETT: ${tubeSize.toFixed(1)} Ù…Ù…`;
  });

  // ---------- Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… ----------
  const adminPass = "mustafa@2006#2";
  document.getElementById('adminLogin').addEventListener('click', ()=>{
    const val=document.getElementById('adminPass').value;
    if(val===adminPass){
      document.getElementById('adminArea').style.display='block';
      alert('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„');
      setTimeout(()=>{document.getElementById('adminArea').style.display='none'; alert('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹');},5*60*1000);
    } else alert('ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø®Ø§Ø·Ø¦Ø©');
  });

  document.getElementById('adminSave').addEventListener('click', ()=>{
    const text = document.getElementById('adminEdit').value;
    const lines=text.split("\n");
    lines.forEach(l=>{
      const parts=l.split(",");
      if(parts.length>=4){
        const drug=parts[0].trim();
        const dose=parseFloat(parts[1].trim());
        const side=parts[2].trim();
        const treatment=parts[3].trim();
        if(!sideEffectsData[drug]) sideEffectsData[drug]=[];
        sideEffectsData[drug].push({dosePerKg:dose, side, treatment});
      }
    });
    populateDrugs();
    alert('ØªÙ… Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª');
  });

  // ---------- Ø´Ø§Øª ÙˆÙ‡Ù…ÙŠ Ù„ÙƒÙ„ Ù‚Ø³Ù… ----------
  function setupChat(inputId, chatId){
    const input=document.getElementById(inputId);
    const chat=document.getElementById(chatId);
    document.getElementById(inputId+'Send').addEventListener('click', ()=>{
      const msg=input.value.trim(); if(!msg) return;
      const userDiv=document.createElement('div'); userDiv.innerHTML=`<strong>Ø£Ù†Øª:</strong> ${msg}`; chat.appendChild(userDiv);
      input.value='';
      const botDiv=document.createElement('div'); botDiv.innerHTML=`<strong>AI:</strong> Ø³ÙŠØªÙ… Ø§Ù„Ø±Ø¯ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª`; chat.appendChild(botDiv);
      chat.scrollTop=chat.scrollHeight;
    });
  }
  setupChat('doseChatInput','doseChat');
  setupChat('fluidsChatInput','fluidsChat');
  setupChat('airwayChatInput','airwayChat');

</script>
</body>
</html>
